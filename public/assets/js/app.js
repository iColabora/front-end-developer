var Database={fetchAllPedidos:function(e){this._execute("select p.numero, p.id, p.id_solicitante, s.nome, DATE_FORMAT(STR_TO_DATE(p.data_de_compra, '%Y-%m-%d'), '%d-%m-%Y') as data_de_compra, (SELECT SUM (m.quantidade*m.preco) FROM materiais as m WHERE m.id_pedido = p.id) as total_materiais, (SELECT SUM (i.quantidade*i.preco) FROM insumos as i WHERE i.id_pedido = p.id) as total_insumos from pedidos as p INNER JOIN solicitantes as s ON s.id = p.id_solicitante",e)},findPedidoByNumero:function(e,i){var t="select p.numero, p.id, p.id_solicitante, s.nome, DATE_FORMAT(STR_TO_DATE(p.data_de_compra, '%Y-%m-%d'), '%d-%m-%Y') as data_de_compra, (SELECT SUM (m.quantidade*m.preco) FROM materiais as m WHERE m.id_pedido = p.id) as total_materiais, (SELECT SUM (i.quantidade*i.preco) FROM insumos as i WHERE i.id_pedido = p.id) as total_insumos from pedidos as p INNER JOIN solicitantes as s ON s.id = p.id_solicitante WHERE p.numero = "+e;this._execute(t,i)},findMaterialByIdPedido:function(e,i){var t="SELECT * FROM materiais WHERE id_pedido = "+e;this._execute(t,i)},findInsumoByIdPedido:function(e,i){var t="SELECT * FROM insumos WHERE id_pedido = "+e;this._execute(t,i)},findSolicitanteById:function(e,i){var t="SELECT * FROM solicitantes WHERE id = "+e;this._execute(t,i)},findSolicitanteByCpf:function(e,i){var t="SELECT * FROM solicitantes WHERE cpf = "+e;this._execute(t,i)},fetchAllSolicitantes:function(e){this._execute("SELECT * FROM solicitantes",e)},fetchPedidosPorDia:function(e){this._execute("select count(*) as total, day(STR_TO_DATE(data_de_compra, '%Y-%m-%d')) as day from pedidos p group by day(STR_TO_DATE(data_de_compra, '%Y-%m-%d'))",e)},fetchPedidosPorSolicitantes:function(e){this._execute("select count(*) total, s.nome from pedidos p inner join solicitantes s on s.id = p.id_solicitante group by p.id_solicitante",e)},_execute:function(e,i){mysqlQuery(e,function(e){var t=JSON.parse(e);i(t)})}},Validator=function(e,i){var t={required:function(i){return e.is("select")?"-1"!=e.val()&&""!=e.val()&&null!=e.val()&&"null"!=e.val():e.is("input")||e.is("textarea")?e.val().length>0:void 0},max:function(i){return e.val().length<=i},min:function(i){return e.val().length>=i}},a=[];this.validate=function(e){for(var i in a){var n=a[i];if(!t[n.name]||!t[n.name](n.opt))return void e(n,!1)}e({},!0)},function(){var e=i.split("|");for(var t in e){var n=e[t].split(":");a[n[0]]={name:n[0],opt:n[1]}}}()},Pedido=function(){var e={},i={},t=[],a=[],n="";this.setAddress=function(i){for(var t in i)e[t]=i[t]},this.setData=function(i){e=i},this.getData=function(){return e},this.setSolicitante=function(e){i=e},this.getSolicitante=function(){return i},this.setMaterial=function(e){t=e},this.getMateriais=function(){return t},this.setInsumos=function(e){console.log("set insumos",a),a=e},this.getInsumos=function(){return console.log("get insumos",a),a},this.setInsurance=function(e){n=e},this.getInsurance=function(){return n},this.get=function(i){return e[i]}},FormWizard=function(e,i,t){var a=$(e),n=[];this.initializeFields=function(){var e=this;for(var n in i)this.initializeField(n,i[n]);this.btnSubmit=a.find(".btn-submit"),this.btnSubmit.click(function(){e.allValidate()&&t()})},this.reloadElements=function(){for(var e in i)i[e].el=$()},this.reload=function(){n=[];for(var e in i)this.initializeField(e,i[e]);this.validateAllFields()},this.initializeField=function(e,i){i.select?$elField=a.find('select[data-field="'+e+'"]'):$elField=a.find('input[data-field="'+e+'"], textarea[data-field="'+e+'"]'),n[e]={els:[],properties:i};for(var t=0;t<$elField.length;t++){var s=$($elField[t]);s.attr("data-index",t),n[e].els.push({el:s,status:!i.rules,validator:i.rules?new Validator(s,i.rules):null})}i.isDate&&this.startDatepicker(n[e]),i.mask&&o(n[e],i.mask,i.onCompleteMask),this.createEvents(n[e])};var o=function(e,i,t){var a={onComplete:t||function(){}};for(var n in e.els)e.els[n].el.mask(i,a)};this.startDatepicker=function(e){var i=this;for(var t in e.els)e.els[t].el.datepicker({format:"dd/mm/yyyy",language:"pt-BR",orientation:"bottom left"}).on("changeDate",function(a){e.els[t].validator&&i.validateField(e.els[t]),i.verifySubmitEnabled(),e.properties&&e.properties.onChangeDate(a)})},this.createEvents=function(e){var i=this;for(var t in e.els)e.els[t].el.is("input")?e.els[t].el.on("keyup",function(t){var a=n[$(this).data("field")].els[$(this).data("index")];a.validator&&i.validateField(a,e),e.properties.keyUp&&e.properties.keyUp(t,a),i.verifySubmitEnabled()}):e.els[t].el.on("change",function(t){console.log("change");var a=n[$(this).data("field")].els[$(this).data("index")];a.validator&&i.validateField(a,e),e.properties.keyUp&&e.properties.keyUp(t,a),i.verifySubmitEnabled()})},this.verifySubmitEnabled=function(){this.allValidate()?this.enableBtnSubmit():this.disableBtnSubmit()},this.validateField=function(e,i){$this=this,e.validator.validate(function(t,a){e.status=a,$this.validateFieldElement(e.el,i.properties,t,a)})},this.validateFieldElement=function(e,i,t,a){var n=e.parent();i.hasLoading&&(n=n.parent()),n.find(".validator-errors span").removeClass("show"),a?n.removeClass("has-error").addClass("has-success"):(n.find('.validator-errors span[data-error="'+t.name+'"]').addClass("show"),n.addClass("has-error"))},this.validateAllFields=function(){for(var e in n)for(var i in n[e].els){var t=n[e],a=n[e].els[i];a.validator?this.validateField(a,t):console.log("No validator ",e)}},this.allValidate=function(){for(var e in n)for(var i in n[e].els)if(!n[e].els[i].status)return!1;return!0},this.setValue=function(e){for(var i in e)n[i]&&(n[i].properties.select?n[i].els[0].el.val(e[i]):n[i].properties.isDate?(n[i].els[0].el.datepicker("update",this.getDate(e[i])),this.validateField(n[i].els[0],n[i])):n[i].els[0].el.attr("value",e[i]))},this.getDate=function(e){var i=e.split("-");return new Date(i[2],i[1],i[0])},this.setEnabled=function(e,i){if(Array.isArray(e))for(var t in e)n[e[t]]&&n[e[t]].els[0].el.removeAttr("disabled");else n[e].els[i].el.removeAttr("disabled")},this.setAllEnabled=function(){for(var e in n)for(var i in n[e].els)this.setEnabled(e,i)},this.setDisabled=function(e,i){if(Array.isArray(e))for(var t in e)n[e[t]]&&n[e[t]].els[0].el.attr("disabled","disabled");else n[e].els[i].el.attr("disabled","disabled")},this.enableBtnSubmit=function(){this.btnSubmit.removeAttr("disabled")},this.disableBtnSubmit=function(){this.btnSubmit.attr("disabled","disabled")},this.get=function(e){var i=[];for(var t in n[e].els)i.push(n[e].els[t].el.val());return 1==i.length?i[0]:i},this.unmask=function(e){return n[e].el.unmask()},this.getCleanValue=function(e){return n[e].el.cleanVal()},this.getAll=function(){var e={};for(var i in n)e[i]=n[i].els[0].el.val();return e},this.showLoading=function(e,i){n[e].els[i].el.parent().find(".image-loading").addClass("show fadeIn")},this.hideLoading=function(e,i){n[e].els[i].el.parent().find(".image-loading").removeClass("fadeIn show")},this.init=function(){a.on("submit",function(e){e.preventDefault()}),this.initializeFields()},this.init()},Paginator=function(e,i,t){var a=this,n=$(e),o=$(i),s={},l=function(){n.click(function(){$(this).hasClass("enabled")&&a.setSelectedPage($(this).attr("href").replace("#",""))})};this.init=function(){l()},this.loadHtml=function(e,i,t){$.ajax({url:"views/"+e+".html"}).done(function(e){i.find(".content").html(e),t()})},this.setSelectedPage=function(e){a=this,o.find(".page").removeClass("show-page").addClass("hide-page"),o.find(".page .loading").removeClass("hide"),o.find(".page .content").removeClass("show"),this.selectedPage=o.find("div[data-page="+e+"]"),this.selectedPage.addClass("show-page").removeClass("hide-page");var i=function(){a.selectedPage.find(".loading").addClass("hide"),a.selectedPage.find(".content").addClass("show")};s[e]?t(e,this.selectedPage.data("title"),i):this.loadHtml(e,this.selectedPage,function(){t(e,a.selectedPage.data("title"),i)})}},CEP={getInfo:function(e,i){$.getJSON("https://viacep.com.br/ws/"+e+"/json/",function(e){if(e.erro)i(e);else{var t={rua:e.logradouro,cidade:e.localidade,bairro:e.bairro,uf:e.uf,pais:"Brasil"};i(t)}})}},ChartPedidos={type:"line",labels:[],data:[],chart:null,el:null,label:"",init:function(e,i,t,a){this.label=i,this.el=e,this.labels=t,this.data=a,this.constructElement()},constructElement:function(){var e=document.getElementById(this.el);e.height=100,this.chart=new Chart(e,{type:this.type,data:{labels:this.labels,datasets:[{label:this.label,data:this.data,backgroundColor:["rgba(255, 99, 132, 0.2)"],borderColor:["rgba(255,99,132,1)"],borderWidth:1}]},options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}})}},FormPedido=function(e,i,t){var a=null,n=null,o=0,s=0;this.init=function(){var e=this;a=new FormWizard(".form-wizard.form-pedido",{numero:{rules:"required",keyUp:function(i,t){e.keyUpNumero(i,t)},hasLoading:!0},data_de_compra:{rules:"required",isDate:!0,onChangeDate:function(){}}},function(){e.submit()}),t()},this.submit=function(){var t=a.getAll();t.id=o,t.idSolicitante=s,i.setData(t),e.paginatorForms.setSelectedPage("formSolicitante")},this.keyUpNumero=function(e,i){i.status&&(clearTimeout(n),n=setTimeout(function(){""!=a.get("numero")?(a.setDisabled(["numero","data_de_compra"]),a.showLoading("numero",0),Database.findPedidoByNumero(a.get("numero"),function(e){if(a.setEnabled(["numero"]),1==e.length){e=e[0],a.setValue(e),a.verifySubmitEnabled(),e.total=e.total_materiais+e.total_insumos;var i=$(".fields-pedido");for(var t in e){var n=e[t];"total_materiais"!=t&&"total_insumos"!=t&&"total"!=t||(n=n.toFixed(2)),i.find('li[data-field="'+t+'"] span').text(n)}o=e.id,s=e.id_solicitante,$(".about-pedido").removeClass("hide")}else o=0,$(".about-pedido").addClass("hide");a.setEnabled(["data_de_compra"]),a.hideLoading("numero",0)})):$(".about-pedido").addClass("hide")},1e3))},this.init()},FormSolicitante=function(e,i,t){var a=null,n=null;this.init=function(){var e=this;a=new FormWizard(".form-solicitante",{nome:{rules:"required|min:3|max:100"},telefone:{rules:"required",mask:"(00) 00000-0000"},cpf:{rules:"required",mask:"000.000.000-00",onCompleteMask:function(){e.searchSolicitante()},hasLoading:!0},cep:{rules:"required",mask:"00000-000",onCompleteMask:function(i){e.searchCep(i)},hasLoading:!0},rua:{rules:"required|min:3"},numero:{rules:"required"},complemento:{},estado:{rules:"required",select:!0},cidade:{rules:"required|min:3"}},function(){e.submit()}),this.load()},this.submit=function(){var t=a.getAll();i.setSolicitante(t),e.paginatorForms.setSelectedPage("formMaterial")},this.load=function(){var e=this;0==i.get("id")?t():Database.findSolicitanteById(i.get("idSolicitante"),function(i){if(0==i.length)a.setEnabled(["cep","nome","telefone"]);else{var n=i[0];e.setValueForm(n),a.validateAllFields(),a.verifySubmitEnabled()}t()})},this.setValueForm=function(e){e.cpf=s(e.cpf),e.cep=l(e.cep),e.telefone=o(e.telefone),a.setValue(e),a.setAllEnabled()};var o=function(e){return $("<div>"+e.replace("(").replace(")")+"</div>").mask("(00) 00000-0000").text()},s=function(e){return $("<div>"+e+"</div>").mask("000.000.000-00").text()},l=function(e){return $("<div>"+e+"</div>").mask("00000-000").text()};this.searchCep=function(e){var i=["cep","rua","numero","complemento","cidade","uf"];a.setDisabled(i),CEP.getInfo(e,function(e){a.setValue(e),a.setEnabled(i)})},this.searchSolicitante=function(){var e=this;clearTimeout(n),n=setTimeout(function(){a.setDisabled(["cpf"]);var i=a.getCleanValue("cpf");a.showLoading("cpf"),Database.findSolicitanteByCpf(i,function(i){0==i.length?a.setEnabled(["cep","nome","telefone"]):(e.setValueForm(i[0]),a.validateAllFields(),a.verifySubmitEnabled()),a.hideLoading("cpf")})},1e3)},this.init()},FormMaterial=function(e,i,t){var a=null;this.init=function(){var e=this;a=new FormWizard(".form-wizard.form-material",{id:{},nome:{rules:"required"},marca:{rules:"required"},quantidade:{rules:"required"},preco:{rules:"required"}},function(){e.submit()}),$(".btn-add-material").click(function(){e.addMaterial({})}),this.load()},this.submit=function(){i.setMaterial(this.constructObject(a.get("id"),a.get("nome"),a.get("marca"),a.get("quantidade"),a.get("preco"))),e.paginatorForms.setSelectedPage("formInsumo")},this.constructObject=function(e,i,t,a,n){if(Array.isArray(e)){var o=[];for(var s in e)o.push({id:e[s],nome:i[s],marca:t[s],quantidade:a[s],preco:n[s]});return o}return[{id:e,nome:i,marca:t,quantidade:a,preco:n}]},this.htmlMaterial=function(e){return'<li class="list-group-item"><input type="hidden" data-field="id" name="id[]" class="form-control" value="'+(e.id?e.id:0)+'" id="id"><div class="form-group"><label for="nome" class="control-label">Nome</label><input type="text" value="'+(e.nome?e.nome:"")+'" name="nome[]" class="form-control" data-field="nome" placeholder="Nome"></div><div class="row"><div class="col col-md-4"><div class="form-group"><label for="marca" class="control-label">Marca</label><input type="text" name="marca[]" class="form-control" value="'+(e.marca?e.marca:"")+'" data-field="marca" placeholder="Marca"></div></div><div class="col col-md-3"><div class="form-group"><label for="quantidade" class="control-label">Quantidade</label><input type="number" name="quantidade[]" class="form-control" value="'+(e.quantidade?e.quantidade:0)+'" data-field="quantidade" placeholder="Quantidade"></div></div><div class="col col-md-5"><div class="form-group"><label for="preco" class="control-label">Preço R$</label><input type="number" name="preco[]" value="'+(e.preco?e.preco:0)+'" class="form-control" data-field="preco" placeholder="Preço"></div></div></div></li>'},this.addMaterial=function(e){$(".list-group.list-material").append(this.htmlMaterial(e)),a.reload()},this.load=function(){var e=this,n=i.get("id");(n=!n)?t():Database.findMaterialByIdPedido(i.get("id"),function(i){if(i.length>0){$(".list-group.list-material").html("");for(var n in i)e.injectHtmlMaterial(i[n]);a.reload(),t()}else t()})},this.injectHtmlMaterial=function(e){$(".list-group.list-material").append(this.htmlMaterial(e))},this.init()},FormInsumo=function(e,i,t){var a=null,n="";this.init=function(){var e=this;a=new FormWizard(".form-wizard.form-insumo",{id:{},descricao:{rules:"required"},id_material:{rules:"required",select:!0},quantidade:{rules:"required"},preco:{rules:"required"}},function(){e.submit()}),$(".btn-add-insumo").click(function(){e.addInsumo({})}),this.load()},this.submit=function(){i.setInsumos(this.constructObject(a.get("id"),a.get("descricao"),a.get("id_material"),a.get("quantidade"),a.get("preco"))),e.paginatorForms.setSelectedPage("formAddress")},this.constructObject=function(e,i,t,a,n){if(Array.isArray(e)){var o=[];for(var s in e)o.push({id:e[s],descricao:i[s],id_material:t[s],quantidade:a[s],preco:n[s]});return o}return[{id:e,descricao:i,id_material:t,quantidade:a,preco:n}]},this.htmlInsumo=function(e){return'<li class="list-group-item"><input type="hidden" name="id[]" data-field="id" value="'+(e.id?e.id:0)+'" class="form-control" id="id"><div class="form-group"><label class="control-label">Descrição</label><textarea class="form-control" name="descricao" id="descricao" data-field="descricao" rows="3">'+(e.descricao?e.descricao:"")+'</textarea></div><div class="row"><div class="col col-md-4"><div class="form-group"><label class="control-label">Material</label><select name="material" class="form-control sel-material" data-field="id_material"><option disabled="disabled" value="-1" selected="selected">Selecione um material</option>'+n+'</select></div></div><div class="col col-md-3"><div class="form-group"><label for="quantidade" class="control-label">Quantidade</label><input type="number" name="quantidade[]" value="'+(e.quantidade?e.quantidade:0)+'" class="form-control" data-field="quantidade" placeholder="Quantidade"></div></div><div class="col col-md-5"><div class="form-group"><label for="preco" class="control-label">Preço R$</label><input type="number" name="preco[]" value="'+(e.preco?e.preco:0)+'" class="form-control" data-field="preco" placeholder="Preço"></div></div></div></li>'},this.addInsumo=function(e){$(".list-group.list-insumos").append(this.htmlInsumo(e)),a.reload()},this.load=function(){var e=this;this.createSelectMaterial();var n=i.get("id");(n=!n)?t():Database.findInsumoByIdPedido(i.get("id"),function(i){if(i.length>0){$(".list-group.list-insumos").html("");for(var n in i)e.injectHtmlInsumo(i[n]);a.reload(),t()}else t()})},this.createSelectMaterial=function(){var e=i.getMateriais();for(var t in e)console.log(e),n='<option value="'+(0==e[t].id?t:e[t].id)+'">'+e[t].nome+"</option>"},this.injectHtmlInsumo=function(e){var i=$(this.htmlInsumo(e));e.id_material&&i.find(".sel-material").val(e.id_material),$(".list-group.list-insumos").append(i)},this.init()},FormAddress=function(e,i,t){var a=null,n=null;this.init=function(){var e=this,t=i.getSolicitante();a=new FormWizard(".form-address",{cep:{rules:"required",mask:"00000-000",onCompleteMask:function(i){e.searchCep(i)},hasLoading:!0},rua:{rules:"required|min:3"},numero:{rules:"required"},complemento:{},estado:{rules:"required",select:!0},cidade:{rules:"required|min:3"}},function(){e.submit()}),this.setValueForm(t)},this.submit=function(){(n={}).cep=a.get("cep").replace("-",""),n.rua=a.get("rua"),n.complemento=a.get("complemento"),n.numero=a.get("numero"),n.estado=a.get("estado"),n.cidade=a.get("cidade"),i.setAddress(n),e.paginatorForms.setSelectedPage("formInsurance")};var o=function(e){return $("<div>"+e+"</div>").mask("00000-000").text()};this.setValueForm=function(e){(n={}).cep=o(e.cep),n.rua=e.rua,n.complemento=e.complemento,n.numero=e.numero,n.estado=e.estado,n.cidade=e.cidade,a.setValue(n),a.setAllEnabled(),a.validateAllFields(),a.verifySubmitEnabled(),t()},this.searchCep=function(e){var i=["cep","rua","numero","complemento","cidade","uf"];a.setDisabled(i),CEP.getInfo(e,function(e){a.setValue(e),a.setEnabled(i)})},this.init()},FormInsurance=function(e,i,t){var a=null,n="";this.init=function(){var e=this;(a=$(".form-insurance")).find(".btn-submit").click(function(){e.submit()}),a.find(".insurance").on("change",function(){n=$(this).val(),e.checkEnabledSubmit()}),t()},this.submit=function(){i.setInsurance(n),e.paginatorForms.setSelectedPage("formResumo")},this.checkEnabledSubmit=function(){""!=n&&a.find(".btn-submit").removeAttr("disabled")},this.init()},FormResumo=function(e,i,t){var a=null;this.init=function(){a=$(".form-resumo"),this.setValueForPedido(),this.setValuesForSolicitante(),this.setValuesForMateriais(),this.setValuesForInsumos(),this.setValuesForInsurance(),t()},this.setValueForPedido=function(){var e=a.find('.info[data-info="pedido"]'),t=i.getData();this.setValue(e,t)},this.setValuesForSolicitante=function(){var e=a.find('.info[data-info="solicitante"]'),t=i.getSolicitante();this.setValue(e,t)},this.getHtmlMaterial=function(e){return'<li class="list-group-item"><div class="form-group"><label for="nome" class="control-label">Nome</label><span data-field="nome"></span>'+e.nome+'</div><div class="row"><div class="col col-md-4"><div class="form-group"><label for="marca" class="control-label">Marca</label><span data-field="marca">'+e.marca+'</span></div></div><div class="col col-md-3"><div class="form-group"><label for="quantidade" class="control-label">Quantidade</label><span data-field="quantidade">'+e.quantidade+'</span></div></div><div class="col col-md-5"><div class="form-group"><label for="preco" class="control-label">Preço R$</label><span data-field="preco">'+e.preco+"</span></div></div></div></li>"},this.setValuesForMateriais=function(){var e=i.getMateriais();for(var t in e)a.find(".list-material").append(this.getHtmlMaterial(e[t]))},this.getHtmlInsumo=function(e){return'<li class="list-group-item"><div class="form-group"><label class="control-label">Descrição</label><span data-field="descricao">'+e.descricao+'</span></div><div class="row"><div class="col col-md-4"><div class="form-group"><label class="control-label">Material</label><span data-field="material">'+e.id_material+'</span></div></div><div class="col col-md-3"><div class="form-group"><label for="quantidade" class="control-label">Quantidade</label><span data-field="quantidade">'+e.quantidade+'</span></div></div><div class="col col-md-5"><div class="form-group"><label for="preco" class="control-label">Preço R$</label><span data-field="preco">'+e.preco+"</span></div></div></div></li>"},this.setValuesForInsumos=function(){var e=i.getInsumos();for(var t in e)a.find(".list-insumos").append(this.getHtmlInsumo(e[t]))},this.setValuesForInsurance=function(){var e=i.getInsurance(),t="";console.log(e),t="s"==e?"Optou pelo seguro extra":"Não optou pelo seguro extra",a.find(".insurance").text(t)},this.setValue=function(e,i){for(var t in i){var a=e.find('span[data-field="'+t+'"]');a&&a.text(i[t])}},this.init()},Core={paginatorMenu:null,paginatorForms:null,validator:null,formPedido:null,formSolicitante:null,formMaterial:null,formInsumo:null,formInsurance:null,formAddress:null,formResumo:null,pedido:null,init:function(){var e=this;this.paginatorMenu=new Paginator(".page-change",".paginator",function(i,t,a){e.pages[i](e,a)}),this.paginatorMenu.init(),String.prototype.replaceAll=function(e,i){return this.replace(new RegExp(e,"g"),i)},this.paginatorMenu.setSelectedPage("dashboard1"),$(".change-sub-navbar").click(function(){e.changeSubNavbar($(this).data("subnavbar"))}),$(".navbar .navbar-nav a").click(function(){$(".navbar .navbar-nav li").removeClass("active"),$(this).addClass("active")})},changeSubNavbar:function(e){$(".sub-navbar").addClass("hide"),$(".sub-navbar."+e).removeClass("hide")},pages:{dashboard1:function(e,i){Database.fetchPedidosPorDia(function(t){t=e.prepareResultPorDia(t),ChartPedidos.init("chartOne","# pedidos por dia",t.labels,t.data),i()})},dashboard2:function(e,i){Database.fetchPedidosPorSolicitantes(function(t){t=e.prepareResultPorSolicitante(t),ChartPedidos.init("chartTwo","# pedidos por solicitante",t.labels,t.data),i()})},dashboard3:function(e,i){Database.fetchAllPedidos(function(e){var t=[];for(var a in e){var n=Number(e[a].total_materiais)+Number(e[a].total_insumos);t.push([e[a].numero,e[a].nome,e[a].data_de_compra.replaceAll("-","/"),"R$ "+e[a].total_materiais.toFixed(2),"R$ "+e[a].total_insumos.toFixed(2),"R$ "+n.toFixed(2)])}$("#table-pedidos").DataTable({columns:[{title:"Numero"},{title:"Solicitante"},{title:"Data de compra"},{title:"Total em Materiais"},{title:"Total em Insumos"},{title:"Total da compra"}],data:t}),i()})},process:function(e,i){e.pedido||(e.pedido=new Pedido),e.paginatorForms=new Paginator("--",".paginator.forms",function(i,t,a){e.changeTitleHeader(t),console.log("Change page",i),"formPedido"==i?e.formPedido||(e.formPedido=new FormPedido(e,e.pedido,a)):"formSolicitante"==i?e.formSolicitante||(e.formSolicitante=new FormSolicitante(e,e.pedido,a)):"formMaterial"==i?e.formMaterial||(e.formMaterial=new FormMaterial(e,e.pedido,a)):"formInsumo"==i?e.formInsumo||(e.formInsumo=new FormInsumo(e,e.pedido,a)):"formAddress"==i?e.formAddress||(e.formAddress=new FormAddress(e,e.pedido,a)):"formInsurance"==i?e.formInsurance||(e.formInsurance=new FormInsurance(e,e.pedido,a)):"formResumo"==i?e.formResumo||(e.formResumo=new FormResumo(e,e.pedido,a)):"formFinish"==i&&(e.formFinish||(e.formFinish=new FormFinish(e,e.pedido,a)))}),e.paginatorForms.init(),e.paginatorForms.setSelectedPage("FormFinish"),i()}},changeTitleHeader:function(e){$(".title-header h2").text(e)},prepareResultPorSolicitante:function(e){var i={labels:[],data:[]};for(var t in e)i.labels.push(e[t].nome),i.data.push(e[t].total);return i},prepareResultPorDia:function(e){var i={data:[],labels:[]};for(var t in e)i.labels.push(this.prepareNumber(e[t].day)),i.data.push(e[t].total);return i},prepareNumber:function(e){return e<10?"0"+e:e}};Core.init();